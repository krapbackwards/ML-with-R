% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Naive Bayes particles},
  pdfauthor={Joseph Park},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

\title{Naive Bayes particles}
\author{Joseph Park}
\date{4/11/2020}

\begin{document}
\maketitle

\hypertarget{data-and-packages}{%
\subsection{data and packages}\label{data-and-packages}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(class)}

\KeywordTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages ----------------------------------------------------------- tidyverse 1.3.0 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.0     v purrr   0.3.3
## v tibble  3.0.0     v dplyr   0.8.5
## v tidyr   1.0.2     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.5.0
\end{verbatim}

\begin{verbatim}
## -- Conflicts -------------------------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(gmodels)}

\KeywordTok{library}\NormalTok{(MLmetrics)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'MLmetrics'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:base':
## 
##     Recall
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(e1071)}

\KeywordTok{library}\NormalTok{(naivebayes)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## naivebayes 0.9.7 loaded
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{particle <-}\StringTok{ }\KeywordTok{read_csv}\NormalTok{(}\StringTok{"C:/Users/parkj/OneDrive/Documents/joe/ML with R/pid-5M.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Parsed with column specification:
## cols(
##   id = col_double(),
##   p = col_double(),
##   theta = col_double(),
##   beta = col_double(),
##   nphe = col_double(),
##   ein = col_double(),
##   eout = col_double()
## )
\end{verbatim}

\hypertarget{sample-randomly-due-to-too-much-data-for-my-laptop-to-process}{%
\subsection{sample (randomly) due to too much data for my laptop to
process}\label{sample-randomly-due-to-too-much-data-for-my-laptop-to-process}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{47}\NormalTok{)}
\NormalTok{particles <-}\StringTok{ }\NormalTok{particle[}\KeywordTok{sample}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(particle), }\DecValTok{50000}\NormalTok{), ]}

\NormalTok{particles}\OperatorTok{$}\NormalTok{id <-}\StringTok{ }\KeywordTok{as.character}\NormalTok{(particles}\OperatorTok{$}\NormalTok{id)}
\CommentTok{#print(particles[complete.cases(particles) == TRUE, ])}

\KeywordTok{print}\NormalTok{(}\KeywordTok{which}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(particles)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## integer(0)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(}\KeywordTok{summary}\NormalTok{(particles))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       id                  p              theta              beta       
##  Length:50000       Min.   :0.2101   Min.   :0.09318   Min.   :0.5501  
##  Class :character   1st Qu.:0.6688   1st Qu.:0.28107   1st Qu.:0.8374  
##  Mode  :character   Median :1.0701   Median :0.40215   Median :0.9460  
##                     Mean   :1.2352   Mean   :0.48677   Mean   :0.8995  
##                     3rd Qu.:1.6564   3rd Qu.:0.60799   3rd Qu.:0.9854  
##                     Max.   :4.7210   Max.   :2.19003   Max.   :1.4903  
##       nphe              ein               eout        
##  Min.   :  0.000   Min.   :0.00000   Min.   :0.00000  
##  1st Qu.:  0.000   1st Qu.:0.00000   1st Qu.:0.00000  
##  Median :  0.000   Median :0.03484   Median :0.04450  
##  Mean   :  3.563   Mean   :0.05664   Mean   :0.07125  
##  3rd Qu.:  0.000   3rd Qu.:0.06812   3rd Qu.:0.09468  
##  Max.   :347.000   Max.   :0.85484   Max.   :0.95280
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}
  \KeywordTok{print}\NormalTok{(}\KeywordTok{sd}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(particles[,i])))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.7429433
## [1] 0.2933541
## [1] 0.1130698
## [1] 17.76838
## [1] 0.07868224
## [1] 0.1035395
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#since one of the features has significantly higher variance, we may want to transform}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}
  \KeywordTok{hist}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(particles[,i]))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-4-1.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-4-2.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-4-3.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-4-4.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-4-5.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-4-6.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#looks like Poisson, but not integers, so multinomial, so may want to try classifiers with different distribution pdf's}
\end{Highlighting}
\end{Shaded}

\hypertarget{split-data}{%
\subsection{Split data}\label{split-data}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{particles_train <-}\StringTok{ }\NormalTok{particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{45000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{]}
\NormalTok{particles_test <-}\StringTok{ }\NormalTok{particles[}\DecValTok{45001}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{]}

\NormalTok{particles_train_labels <-}\StringTok{ }\NormalTok{particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{45000}\NormalTok{, }\DecValTok{1}\NormalTok{]}
\NormalTok{particles_test_labels <-}\StringTok{ }\NormalTok{particles[}\DecValTok{45001}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\hypertarget{train-classifier-on-training-data-and-classify-test-data}{%
\subsection{Train classifier on training data and classify test
data}\label{train-classifier-on-training-data-and-classify-test-data}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#generating classification for different k's to find best accuracy}
\NormalTok{accuracy =}\StringTok{ }\DecValTok{1}\OperatorTok{:}\DecValTok{2}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{)\{}

\NormalTok{  bayes_classifier <-}\StringTok{ }\KeywordTok{naiveBayes}\NormalTok{(particles_train, }\KeywordTok{as.factor}\NormalTok{(particles_train_labels[,}\DecValTok{1}\NormalTok{, }\DataTypeTok{drop =} \OtherTok{TRUE}\NormalTok{]), }\DataTypeTok{laplace =}\NormalTok{ i}\DecValTok{-1}\NormalTok{)}

\NormalTok{  particles_test_pred <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(bayes_classifier, particles_test)}
    
  \CommentTok{#metric}
\NormalTok{  accuracy[i] <-}\StringTok{ }\KeywordTok{Accuracy}\NormalTok{(particles_test_pred, particles_test_labels[,}\DecValTok{1}\NormalTok{, }\DataTypeTok{drop =} \OtherTok{TRUE}\NormalTok{])}

\CommentTok{#get best accurracy and corresponding index (k)}
  \ControlFlowTok{if}\NormalTok{ (i }\OperatorTok{>}\StringTok{ }\DecValTok{1}\NormalTok{)\{}
    \ControlFlowTok{if}\NormalTok{ (accuracy[i] }\OperatorTok{>}\StringTok{ }\NormalTok{bestacc)\{}
\NormalTok{      bestacc <-}\StringTok{ }\NormalTok{accuracy[i]}
\NormalTok{      bestk <-}\StringTok{ }\NormalTok{i}
\NormalTok{    \}}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    bestacc <-}\StringTok{ }\NormalTok{accuracy[i]}
\NormalTok{    bestk <-}\StringTok{ }\NormalTok{i}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{metrics}{%
\subsection{Metrics}\label{metrics}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(accuracy[}\DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-7-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"The best accuracy is"}\NormalTok{, bestacc))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "The best accuracy is 0.8576"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#particles_test_pred <- knn(train = particles_train, test = particles_test, cl = particles_train_labels[,1, drop = TRUE], k = bestk)}
\KeywordTok{CrossTable}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ particles_test_labels[,}\DecValTok{1}\NormalTok{, }\DataTypeTok{drop =} \OtherTok{TRUE}\NormalTok{], }\DataTypeTok{y =}\NormalTok{ particles_test_pred, }\DataTypeTok{prop.chisq=}\OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## |           N / Row Total |
## |           N / Col Total |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  5000 
## 
##  
##                                         | particles_test_pred 
## particles_test_labels[, 1, drop = TRUE] |       -11 |       211 |      2212 |       321 | Row Total | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                     -11 |         1 |        12 |         0 |         0 |        13 | 
##                                         |     0.077 |     0.923 |     0.000 |     0.000 |     0.003 | 
##                                         |     0.019 |     0.004 |     0.000 |     0.000 |           | 
##                                         |     0.000 |     0.002 |     0.000 |     0.000 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                     211 |        49 |      2501 |       143 |       128 |      2821 | 
##                                         |     0.017 |     0.887 |     0.051 |     0.045 |     0.564 | 
##                                         |     0.942 |     0.918 |     0.073 |     0.502 |           | 
##                                         |     0.010 |     0.500 |     0.029 |     0.026 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                    2212 |         2 |        86 |      1756 |        97 |      1941 | 
##                                         |     0.001 |     0.044 |     0.905 |     0.050 |     0.388 | 
##                                         |     0.038 |     0.032 |     0.891 |     0.380 |           | 
##                                         |     0.000 |     0.017 |     0.351 |     0.019 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                     321 |         0 |       124 |        71 |        30 |       225 | 
##                                         |     0.000 |     0.551 |     0.316 |     0.133 |     0.045 | 
##                                         |     0.000 |     0.046 |     0.036 |     0.118 |           | 
##                                         |     0.000 |     0.025 |     0.014 |     0.006 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                            Column Total |        52 |      2723 |      1970 |       255 |      5000 | 
##                                         |     0.010 |     0.545 |     0.394 |     0.051 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
## 
## 
\end{verbatim}

\hypertarget{now-normalized}{%
\section{now normalized}\label{now-normalized}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{normalize <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x) \{}
\KeywordTok{return}\NormalTok{ ((x }\OperatorTok{-}\StringTok{ }\KeywordTok{min}\NormalTok{(x)) }\OperatorTok{/}\StringTok{ }\NormalTok{(}\KeywordTok{max}\NormalTok{(x) }\OperatorTok{-}\StringTok{ }\KeywordTok{min}\NormalTok{(x)))}
\NormalTok{\}}

\NormalTok{particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{] <-}\StringTok{ }\KeywordTok{normalize}\NormalTok{(particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{])}


\CommentTok{#To confirm that the transformation was applied correctly, let's look at one variable's summary statistics:}
\KeywordTok{summary}\NormalTok{(particles)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       id                  p                 theta                beta         
##  Length:50000       Min.   :0.0006055   Min.   :0.0002685   Min.   :0.001585  
##  Class :character   1st Qu.:0.0019274   1st Qu.:0.0008100   1st Qu.:0.002413  
##  Mode  :character   Median :0.0030839   Median :0.0011589   Median :0.002726  
##                     Mean   :0.0035597   Mean   :0.0014028   Mean   :0.002592  
##                     3rd Qu.:0.0047736   3rd Qu.:0.0017521   3rd Qu.:0.002840  
##                     Max.   :0.0136052   Max.   :0.0063113   Max.   :0.004295  
##       nphe              ein                 eout          
##  Min.   :0.00000   Min.   :0.0000000   Min.   :0.0000000  
##  1st Qu.:0.00000   1st Qu.:0.0000000   1st Qu.:0.0000000  
##  Median :0.00000   Median :0.0001004   Median :0.0001282  
##  Mean   :0.01027   Mean   :0.0001632   Mean   :0.0002053  
##  3rd Qu.:0.00000   3rd Qu.:0.0001963   3rd Qu.:0.0002728  
##  Max.   :1.00000   Max.   :0.0024635   Max.   :0.0027458
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}
  \KeywordTok{print}\NormalTok{(}\KeywordTok{sd}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(particles[,i])))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.002141047
## [1] 0.000845401
## [1] 0.0003258494
## [1] 0.05120571
## [1] 0.00022675
## [1] 0.0002983847
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}
  \KeywordTok{hist}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(particles[,i]))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-10-1.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-10-2.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-10-3.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-10-4.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-10-5.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-10-6.pdf}
\#\# Split data

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{particles_train <-}\StringTok{ }\NormalTok{particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{45000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{]}
\NormalTok{particles_test <-}\StringTok{ }\NormalTok{particles[}\DecValTok{45001}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{]}

\NormalTok{particles_train_labels <-}\StringTok{ }\NormalTok{particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{45000}\NormalTok{, }\DecValTok{1}\NormalTok{]}
\NormalTok{particles_test_labels <-}\StringTok{ }\NormalTok{particles[}\DecValTok{45001}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\hypertarget{train-classifier-on-training-data-and-classify-test-data-1}{%
\subsection{Train classifier on training data and classify test
data}\label{train-classifier-on-training-data-and-classify-test-data-1}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#generating classification for different k's to find best accuracy}
\NormalTok{accuracy =}\StringTok{ }\DecValTok{1}\OperatorTok{:}\DecValTok{2}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{)\{}

\NormalTok{  bayes_classifier <-}\StringTok{ }\KeywordTok{naiveBayes}\NormalTok{(particles_train, }\KeywordTok{as.factor}\NormalTok{(particles_train_labels[,}\DecValTok{1}\NormalTok{, }\DataTypeTok{drop =} \OtherTok{TRUE}\NormalTok{]), }\DataTypeTok{laplace =}\NormalTok{ i}\DecValTok{-1}\NormalTok{)}

\NormalTok{  particles_test_pred <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(bayes_classifier, particles_test)}
    
  \CommentTok{#metric}
\NormalTok{  accuracy[i] <-}\StringTok{ }\KeywordTok{Accuracy}\NormalTok{(particles_test_pred, particles_test_labels[,}\DecValTok{1}\NormalTok{, }\DataTypeTok{drop =} \OtherTok{TRUE}\NormalTok{])}

\CommentTok{#get best accurracy and corresponding index (k)}
  \ControlFlowTok{if}\NormalTok{ (i }\OperatorTok{>}\StringTok{ }\DecValTok{1}\NormalTok{)\{}
    \ControlFlowTok{if}\NormalTok{ (accuracy[i] }\OperatorTok{>}\StringTok{ }\NormalTok{bestacc)\{}
\NormalTok{      bestacc <-}\StringTok{ }\NormalTok{accuracy[i]}
\NormalTok{      bestk <-}\StringTok{ }\NormalTok{i}
\NormalTok{    \}}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    bestacc <-}\StringTok{ }\NormalTok{accuracy[i]}
\NormalTok{    bestk <-}\StringTok{ }\NormalTok{i}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{metrics-1}{%
\subsection{Metrics}\label{metrics-1}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(accuracy[}\DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-13-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"The best accuracy is"}\NormalTok{, bestacc))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "The best accuracy is 0.8576"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#particles_test_pred <- knn(train = particles_train, test = particles_test, cl = particles_train_labels[,1, drop = TRUE], k = bestk)}
\KeywordTok{CrossTable}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ particles_test_labels[,}\DecValTok{1}\NormalTok{, }\DataTypeTok{drop =} \OtherTok{TRUE}\NormalTok{], }\DataTypeTok{y =}\NormalTok{ particles_test_pred, }\DataTypeTok{prop.chisq=}\OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## |           N / Row Total |
## |           N / Col Total |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  5000 
## 
##  
##                                         | particles_test_pred 
## particles_test_labels[, 1, drop = TRUE] |       -11 |       211 |      2212 |       321 | Row Total | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                     -11 |         1 |        12 |         0 |         0 |        13 | 
##                                         |     0.077 |     0.923 |     0.000 |     0.000 |     0.003 | 
##                                         |     0.019 |     0.004 |     0.000 |     0.000 |           | 
##                                         |     0.000 |     0.002 |     0.000 |     0.000 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                     211 |        49 |      2501 |       143 |       128 |      2821 | 
##                                         |     0.017 |     0.887 |     0.051 |     0.045 |     0.564 | 
##                                         |     0.942 |     0.918 |     0.073 |     0.502 |           | 
##                                         |     0.010 |     0.500 |     0.029 |     0.026 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                    2212 |         2 |        86 |      1756 |        97 |      1941 | 
##                                         |     0.001 |     0.044 |     0.905 |     0.050 |     0.388 | 
##                                         |     0.038 |     0.032 |     0.891 |     0.380 |           | 
##                                         |     0.000 |     0.017 |     0.351 |     0.019 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                     321 |         0 |       124 |        71 |        30 |       225 | 
##                                         |     0.000 |     0.551 |     0.316 |     0.133 |     0.045 | 
##                                         |     0.000 |     0.046 |     0.036 |     0.118 |           | 
##                                         |     0.000 |     0.025 |     0.014 |     0.006 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                            Column Total |        52 |      2723 |      1970 |       255 |      5000 | 
##                                         |     0.010 |     0.545 |     0.394 |     0.051 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
## 
## 
\end{verbatim}

\hypertarget{now-z-standardized}{%
\section{Now z-standardized}\label{now-z-standardized}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{47}\NormalTok{)}
\NormalTok{particles <-}\StringTok{ }\NormalTok{particle[}\KeywordTok{sample}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(particle), }\DecValTok{50000}\NormalTok{), ]}

\NormalTok{particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{] <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{scale}\NormalTok{(particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{]))}


\CommentTok{#To confirm that the transformation was applied correctly, let's look at one variable's summary statistics:}
\KeywordTok{summary}\NormalTok{(particles)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        id               p               theta              beta        
##  Min.   : -11.0   Min.   :-1.3798   Min.   :-1.3417   Min.   :-3.0906  
##  1st Qu.: 211.0   1st Qu.:-0.7624   1st Qu.:-0.7012   1st Qu.:-0.5494  
##  Median : 211.0   Median :-0.2222   Median :-0.2885   Median : 0.4114  
##  Mean   : 999.3   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  
##  3rd Qu.:2212.0   3rd Qu.: 0.5670   3rd Qu.: 0.4132   3rd Qu.: 0.7598  
##  Max.   :2212.0   Max.   : 4.6919   Max.   : 5.8061   Max.   : 5.2247  
##       nphe              ein               eout        
##  Min.   :-0.2005   Min.   :-0.7198   Min.   :-0.6881  
##  1st Qu.:-0.2005   1st Qu.:-0.7198   1st Qu.:-0.6881  
##  Median :-0.2005   Median :-0.2771   Median :-0.2584  
##  Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  
##  3rd Qu.:-0.2005   3rd Qu.: 0.1459   3rd Qu.: 0.2263  
##  Max.   :19.3285   Max.   :10.1447   Max.   : 8.5142
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}
  \KeywordTok{print}\NormalTok{(}\KeywordTok{sd}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(particles[,i])))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1
## [1] 1
## [1] 1
## [1] 1
## [1] 1
## [1] 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}
  \KeywordTok{hist}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(particles[,i]))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-16-1.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-16-2.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-16-3.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-16-4.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-16-5.pdf}
\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-16-6.pdf}
\#\# Split data

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{particles_train <-}\StringTok{ }\NormalTok{particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{45000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{]}
\NormalTok{particles_test <-}\StringTok{ }\NormalTok{particles[}\DecValTok{45001}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{]}

\NormalTok{particles_train_labels <-}\StringTok{ }\NormalTok{particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{45000}\NormalTok{, }\DecValTok{1}\NormalTok{]}
\NormalTok{particles_test_labels <-}\StringTok{ }\NormalTok{particles[}\DecValTok{45001}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\hypertarget{train-classifier-on-training-data-and-classify-test-data-2}{%
\subsection{Train classifier on training data and classify test
data}\label{train-classifier-on-training-data-and-classify-test-data-2}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#generating classification for different k's to find best accuracy}
\NormalTok{accuracy =}\StringTok{ }\DecValTok{1}\OperatorTok{:}\DecValTok{2}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{)\{}

\NormalTok{  bayes_classifier <-}\StringTok{ }\KeywordTok{naiveBayes}\NormalTok{(particles_train, }\KeywordTok{as.factor}\NormalTok{(particles_train_labels[,}\DecValTok{1}\NormalTok{, }\DataTypeTok{drop =} \OtherTok{TRUE}\NormalTok{]), }\DataTypeTok{laplace =}\NormalTok{ i}\DecValTok{-1}\NormalTok{)}

\NormalTok{  particles_test_pred <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(bayes_classifier, particles_test)}
    
  \CommentTok{#metric}
\NormalTok{  accuracy[i] <-}\StringTok{ }\KeywordTok{Accuracy}\NormalTok{(particles_test_pred, particles_test_labels[,}\DecValTok{1}\NormalTok{, }\DataTypeTok{drop =} \OtherTok{TRUE}\NormalTok{])}

\CommentTok{#get best accurracy and corresponding index (k)}
  \ControlFlowTok{if}\NormalTok{ (i }\OperatorTok{>}\StringTok{ }\DecValTok{1}\NormalTok{)\{}
    \ControlFlowTok{if}\NormalTok{ (accuracy[i] }\OperatorTok{>}\StringTok{ }\NormalTok{bestacc)\{}
\NormalTok{      bestacc <-}\StringTok{ }\NormalTok{accuracy[i]}
\NormalTok{      bestk <-}\StringTok{ }\NormalTok{i}
\NormalTok{    \}}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    bestacc <-}\StringTok{ }\NormalTok{accuracy[i]}
\NormalTok{    bestk <-}\StringTok{ }\NormalTok{i}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{metrics-2}{%
\subsection{Metrics}\label{metrics-2}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(accuracy[}\DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-19-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"The best accuracy is"}\NormalTok{, bestacc))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "The best accuracy is 0.8576"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#particles_test_pred <- knn(train = particles_train, test = particles_test, cl = particles_train_labels[,1, drop = TRUE], k = bestk)}
\KeywordTok{CrossTable}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ particles_test_labels[,}\DecValTok{1}\NormalTok{, }\DataTypeTok{drop =} \OtherTok{TRUE}\NormalTok{], }\DataTypeTok{y =}\NormalTok{ particles_test_pred, }\DataTypeTok{prop.chisq=}\OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## |           N / Row Total |
## |           N / Col Total |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  5000 
## 
##  
##                                         | particles_test_pred 
## particles_test_labels[, 1, drop = TRUE] |       -11 |       211 |       321 |      2212 | Row Total | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                     -11 |         1 |        12 |         0 |         0 |        13 | 
##                                         |     0.077 |     0.923 |     0.000 |     0.000 |     0.003 | 
##                                         |     0.019 |     0.004 |     0.000 |     0.000 |           | 
##                                         |     0.000 |     0.002 |     0.000 |     0.000 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                     211 |        49 |      2501 |       128 |       143 |      2821 | 
##                                         |     0.017 |     0.887 |     0.045 |     0.051 |     0.564 | 
##                                         |     0.942 |     0.918 |     0.502 |     0.073 |           | 
##                                         |     0.010 |     0.500 |     0.026 |     0.029 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                     321 |         0 |       124 |        30 |        71 |       225 | 
##                                         |     0.000 |     0.551 |     0.133 |     0.316 |     0.045 | 
##                                         |     0.000 |     0.046 |     0.118 |     0.036 |           | 
##                                         |     0.000 |     0.025 |     0.006 |     0.014 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                    2212 |         2 |        86 |        97 |      1756 |      1941 | 
##                                         |     0.001 |     0.044 |     0.050 |     0.905 |     0.388 | 
##                                         |     0.038 |     0.032 |     0.380 |     0.891 |           | 
##                                         |     0.000 |     0.017 |     0.019 |     0.351 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                            Column Total |        52 |      2723 |       255 |      1970 |      5000 | 
##                                         |     0.010 |     0.545 |     0.051 |     0.394 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
## 
## 
\end{verbatim}

\hypertarget{now-with-variable-removals}{%
\section{Now with variable removals}\label{now-with-variable-removals}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{47}\NormalTok{)}
\NormalTok{particles <-}\StringTok{ }\NormalTok{particle[}\KeywordTok{sample}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(particle), }\DecValTok{50000}\NormalTok{), ]}

\NormalTok{particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{] <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\hypertarget{split-data-1}{%
\subsection{Split data}\label{split-data-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{particles_train <-}\StringTok{ }\NormalTok{particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{45000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{]}
\NormalTok{particles_test <-}\StringTok{ }\NormalTok{particles[}\DecValTok{45001}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{]}

\NormalTok{particles_train_labels <-}\StringTok{ }\NormalTok{particles[}\DecValTok{1}\OperatorTok{:}\DecValTok{45000}\NormalTok{, }\DecValTok{1}\NormalTok{]}
\NormalTok{particles_test_labels <-}\StringTok{ }\NormalTok{particles[}\DecValTok{45001}\OperatorTok{:}\DecValTok{50000}\NormalTok{, }\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\hypertarget{train-classifier-on-training-data-and-classify-test-data-3}{%
\subsection{Train classifier on training data and classify test
data}\label{train-classifier-on-training-data-and-classify-test-data-3}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#generating classification for different k's to find best accuracy}
\NormalTok{accuracy =}\StringTok{ }\DecValTok{2}\OperatorTok{:}\DecValTok{7}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{)\{}

\NormalTok{ particles_train_r <-}\StringTok{ }\NormalTok{particles_train}
\NormalTok{ particles_train_r[,i] <-}\StringTok{ }\OtherTok{NULL}

\NormalTok{ particles_test_r <-}\StringTok{ }\NormalTok{particles_test}
\NormalTok{ particles_test_r[,i] <-}\StringTok{ }\OtherTok{NULL}

 
\NormalTok{  bayes_classifier <-}\StringTok{ }\KeywordTok{naiveBayes}\NormalTok{(particles_train_r, }\KeywordTok{as.factor}\NormalTok{(particles_train_labels[,}\DecValTok{1}\NormalTok{, }\DataTypeTok{drop =} \OtherTok{TRUE}\NormalTok{]))}

\NormalTok{  particles_test_pred_r <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(bayes_classifier, particles_test_r)}
    
  \CommentTok{#metric}
\NormalTok{  accuracy[i] <-}\StringTok{ }\KeywordTok{Accuracy}\NormalTok{(particles_test_pred_r, particles_test_labels[,}\DecValTok{1}\NormalTok{, }\DataTypeTok{drop =} \OtherTok{TRUE}\NormalTok{])}

\CommentTok{#get best accurracy and corresponding index (k)}
  \ControlFlowTok{if}\NormalTok{ (i }\OperatorTok{>}\StringTok{ }\DecValTok{2}\NormalTok{)\{}
    \ControlFlowTok{if}\NormalTok{ (accuracy[i] }\OperatorTok{>}\StringTok{ }\NormalTok{bestacc)\{}
\NormalTok{      bestacc <-}\StringTok{ }\NormalTok{accuracy[i]}
\NormalTok{      bestk <-}\StringTok{ }\NormalTok{i}
\NormalTok{    \}}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    bestacc <-}\StringTok{ }\NormalTok{accuracy[i]}
\NormalTok{    bestk <-}\StringTok{ }\NormalTok{i}
    \KeywordTok{print}\NormalTok{(i)}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2
\end{verbatim}

\hypertarget{metrics-3}{%
\subsection{Metrics}\label{metrics-3}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(accuracy[}\DecValTok{2}\OperatorTok{:}\DecValTok{7}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\includegraphics{particle-naive-bayes_files/figure-latex/unnamed-chunk-24-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"The best accuracy is"}\NormalTok{, bestacc))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "The best accuracy is 0.8736"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#particles_test_pred <- knn(train = particles_train, test = particles_test, cl = particles_train_labels[,1, drop = TRUE], k = bestk)}
\KeywordTok{CrossTable}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ particles_test_labels[,}\DecValTok{1}\NormalTok{, }\DataTypeTok{drop =} \OtherTok{TRUE}\NormalTok{], }\DataTypeTok{y =}\NormalTok{ particles_test_pred_r, }\DataTypeTok{prop.chisq=}\OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## |           N / Row Total |
## |           N / Col Total |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  5000 
## 
##  
##                                         | particles_test_pred_r 
## particles_test_labels[, 1, drop = TRUE] |       -11 |       211 |       321 |      2212 | Row Total | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                     -11 |         1 |        12 |         0 |         0 |        13 | 
##                                         |     0.077 |     0.923 |     0.000 |     0.000 |     0.003 | 
##                                         |     0.019 |     0.004 |     0.000 |     0.000 |           | 
##                                         |     0.000 |     0.002 |     0.000 |     0.000 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                     211 |        49 |      2501 |       128 |       143 |      2821 | 
##                                         |     0.017 |     0.887 |     0.045 |     0.051 |     0.564 | 
##                                         |     0.942 |     0.918 |     0.502 |     0.073 |           | 
##                                         |     0.010 |     0.500 |     0.026 |     0.029 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                     321 |         0 |       124 |        30 |        71 |       225 | 
##                                         |     0.000 |     0.551 |     0.133 |     0.316 |     0.045 | 
##                                         |     0.000 |     0.046 |     0.118 |     0.036 |           | 
##                                         |     0.000 |     0.025 |     0.006 |     0.014 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                                    2212 |         2 |        86 |        97 |      1756 |      1941 | 
##                                         |     0.001 |     0.044 |     0.050 |     0.905 |     0.388 | 
##                                         |     0.038 |     0.032 |     0.380 |     0.891 |           | 
##                                         |     0.000 |     0.017 |     0.019 |     0.351 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
##                            Column Total |        52 |      2723 |       255 |      1970 |      5000 | 
##                                         |     0.010 |     0.545 |     0.051 |     0.394 |           | 
## ----------------------------------------|-----------|-----------|-----------|-----------|-----------|
## 
## 
\end{verbatim}

\end{document}
